# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on release
'on':
  push:
    tags:        
      - '*' # Push events to every tag not containing / Refer https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#patterns-to-match-branches-and-tags
jobs:
  call-workflow-in-another-repo:
    uses: hotwax/dxp-components/.github/workflows/common-firebase-hosting-release.yml@main
    with:
      config-path: .github/labeler.yml
    secrets:
      envPAT: ${{ secrets.envPAT }}
      HOTWAX_PUBLIC_SECRET: ${{ secrets.HOTWAX_PUBLIC_SECRET }}

  run-playwright-automation:
      runs-on: ubuntu-latest
      needs: deploy-to-firebase-hosting
      steps:
        - name: Checkout repository
          uses: actions/checkout@v2
  
        - name: Set up Node.js
          uses: actions/setup-node@v2
          with:
            node-version: '20'
  
        - name: Install dependencies
          run: npm install

        - name: Build
          run: npm run build
  
        - name: Run Playwright automation script
          run: npm run test
